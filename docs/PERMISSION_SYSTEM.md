# üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Permission System)

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
2. [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå](#‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå)
3. [Roles ‡πÅ‡∏•‡∏∞ Permissions](#roles-‡πÅ‡∏•‡∏∞-permissions)
4. [‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô](#‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
5. [‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô](#‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
6. [‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö](#‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö)

---

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö

‡∏£‡∏∞‡∏ö‡∏ö Permission ‡∏Ç‡∏≠‡∏á Dashboard MIS ‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ **Component-level Permission** ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ Component ‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å

- ‚úÖ **Component-level Permission**: ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å Component ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô
- ‚úÖ **3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**: `none`, `view`, `full`
- ‚úÖ **5 Roles ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô**: Admin, Manager, Sales, Purchase, Accountant
- ‚úÖ **React Context API**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ state ‡πÅ‡∏ö‡∏ö global
- ‚úÖ **Mock Data**: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
- ‚úÖ **Easy to extend**: ‡πÄ‡∏û‡∏¥‡πà‡∏° Role ‡∏´‡∏£‡∏∑‡∏≠ Permission ‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢

---

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
src/
‚îú‚îÄ‚îÄ lib/permissions/
‚îÇ   ‚îú‚îÄ‚îÄ types.ts                    # TypeScript interfaces ‡πÅ‡∏•‡∏∞ types
‚îÇ   ‚îú‚îÄ‚îÄ mockData.ts                 # Mock roles ‡πÅ‡∏•‡∏∞ users ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
‚îÇ   ‚îú‚îÄ‚îÄ PermissionContext.tsx       # React Context ‡πÅ‡∏•‡∏∞ Hooks
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                    # Barrel export
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ PermissionGuard.tsx         # Component wrapper ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
‚îî‚îÄ‚îÄ app/
    ‚îú‚îÄ‚îÄ layout.tsx                  # Root layout (‡∏°‡∏µ PermissionProvider)
    ‚îî‚îÄ‚îÄ api/auth/
        ‚îú‚îÄ‚îÄ user/route.ts           # API: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user
        ‚îú‚îÄ‚îÄ permissions/route.ts    # API: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
        ‚îî‚îÄ‚îÄ roles/route.ts          # API: ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ roles
```

---

## Roles ‡πÅ‡∏•‡∏∞ Permissions

### 1. Admin (‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å Module ‡πÅ‡∏•‡∏∞‡∏ó‡∏∏‡∏Å Component
- **Level**: `full` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### 2. Manager (‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å Module ‡πÅ‡∏ï‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞ `view`
- **Level**: `view` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### 3. Sales (‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**:
  - Sales Module: `full` (‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô `view`)
  - Inventory Module: `view` (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô)
  - Accounting & Purchase: `none`

### 4. Purchase (‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**:
  - Purchase Module: `full`
  - Inventory Module: `full`
  - Accounting & Sales: `none`

### 5. Accountant (‡∏ô‡∏±‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**:
  - Accounting Module: `full`
  - Sales, Purchase, Inventory: `view` (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô)

---

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. Setup PermissionProvider

‡πÉ‡∏ô `src/app/layout.tsx`:

```tsx
import { PermissionProvider } from '@/lib/permissions';

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <PermissionProvider>
          {/* Your app */}
          {children}
        </PermissionProvider>
      </body>
    </html>
  );
}
```

### 2. ‡πÉ‡∏ä‡πâ PermissionGuard Component

‡∏Ñ‡∏£‡∏≠‡∏ö Component ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:

```tsx
import { PermissionGuard } from '@/components/PermissionGuard';

function MyPage() {
  return (
    <div>
      <PermissionGuard componentKey="sales.kpis">
        <KPICards />
      </PermissionGuard>

      <PermissionGuard componentKey="sales.top_products">
        <TopProductsTable />
      </PermissionGuard>
    </div>
  );
}
```

### 3. ‡πÉ‡∏ä‡πâ Hooks

```tsx
import { usePermissions, useComponentPermission, useModuleAccess } from '@/lib/permissions';

function MyComponent() {
  // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user ‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
  const { user, checkPermission } = usePermissions();

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå component ‡πÄ‡∏â‡∏û‡∏≤‡∏∞
  const { allowed, level } = useComponentPermission('sales.kpis');

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå module
  const hasAccess = useModuleAccess('sales');

  return (
    <div>
      {allowed && <p>‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á</p>}
      {level === 'view' && <p>‡πÇ‡∏´‡∏°‡∏î‡∏î‡∏π‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>}
      {hasAccess && <p>‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Sales Module ‡πÑ‡∏î‡πâ</p>}
    </div>
  );
}
```

---

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 1: Sales Dashboard Page

```tsx
'use client';

import { useState, useEffect } from 'react';
import { PermissionGuard } from '@/components/PermissionGuard';
import { KPICard } from '@/components/KPICard';
import { DataCard } from '@/components/DataCard';
// ... imports ‡∏≠‡∏∑‡πà‡∏ô‡πÜ

export default function SalesPage() {
  // ... states ‡πÅ‡∏•‡∏∞ data fetching

  return (
    <div className="space-y-6">
      {/* Header */}
      <div>
        <h1>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h1>
      </div>

      {/* KPI Cards */}
      <PermissionGuard componentKey="sales.kpis">
        <div className="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
          <KPICard title="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°" value={totalSales} />
          <KPICard title="‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô" value={grossProfit} />
          {/* ... */}
        </div>
      </PermissionGuard>

      {/* Sales Trend Chart */}
      <PermissionGuard componentKey="sales.trend">
        <DataCard title="‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢">
          <SalesTrendChart data={trendData} />
        </DataCard>
      </PermissionGuard>

      {/* Top Products */}
      <PermissionGuard componentKey="sales.top_products">
        <DataCard title="‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ Top 10">
          <TopProductsTable data={topProducts} />
        </DataCard>
      </PermissionGuard>

      {/* ... components ‡∏≠‡∏∑‡πà‡∏ô‡πÜ */}
    </div>
  );
}
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 2: Show/Hide ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢

```tsx
import { Show, Hide } from '@/components/PermissionGuard';

function MyComponent() {
  return (
    <div>
      {/* ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå */}
      <Show if="sales.kpis">
        <KPICards />
      </Show>

      {/* ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå */}
      <Hide if="sales.kpis">
        <p>‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ</p>
      </Hide>
    </div>
  );
}
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 3: ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç

```tsx
import { useComponentPermission } from '@/lib/permissions';

function MyComponent() {
  const { allowed, level } = useComponentPermission('purchase.top_suppliers');

  if (!allowed) {
    return <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á</p>;
  }

  return (
    <div>
      <h2>Top Suppliers</h2>
      {level === 'view' && <Badge>View Only</Badge>}
      {level === 'full' && <Button>Add New</Button>}
    </div>
  );
}
```

---

## Component Keys ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### Accounting Module
- `accounting.kpis` - KPI Cards
- `accounting.pl_statement` - P&L Statement
- `accounting.balance_sheet` - Balance Sheet
- `accounting.cash_flow` - Cash Flow
- `accounting.ar_aging` - AR Aging
- `accounting.ap_aging` - AP Aging
- `accounting.revenue_breakdown` - Revenue Breakdown
- `accounting.expense_breakdown` - Expense Breakdown

### Sales Module
- `sales.kpis` - KPI Cards
- `sales.trend` - Sales Trend Chart
- `sales.top_products` - Top Products Table
- `sales.by_branch` - Sales by Branch Chart
- `sales.by_salesperson` - Sales by Salesperson Table
- `sales.top_customers` - Top Customers Table
- `sales.ar_status` - AR Status Chart

### Purchase Module
- `purchase.kpis` - KPI Cards
- `purchase.trend` - Purchase Trend Chart
- `purchase.top_suppliers` - Top Suppliers Table
- `purchase.by_category` - Purchase by Category Chart
- `purchase.by_brand` - Purchase by Brand Chart
- `purchase.ap_outstanding` - AP Outstanding Table

### Inventory Module
- `inventory.kpis` - KPI Cards
- `inventory.stock_movement` - Stock Movement Chart
- `inventory.low_stock` - Low Stock Table
- `inventory.overstock` - Overstock Table
- `inventory.slow_moving` - Slow Moving Items Table
- `inventory.turnover` - Inventory Turnover Chart
- `inventory.by_branch` - Stock by Branch Chart

---

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### 1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Mock Users

‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `src/lib/permissions/mockData.ts` ‡∏°‡∏µ `getMockCurrentUser()` ‡∏ó‡∏µ‡πà return **Manager Role** ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Role ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ:

```typescript
// mockData.ts
export function getMockCurrentUser(): User {
  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô index ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö Role ‡∏ï‡πà‡∏≤‡∏á‡πÜ
  return mockUsers[0]; // Admin
  // return mockUsers[1]; // Manager
  // return mockUsers[2]; // Sales
  // return mockUsers[3]; // Purchase
  // return mockUsers[4]; // Accountant
}
```

### 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô API

```bash
# ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
curl http://localhost:3000/api/auth/user

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå component
curl http://localhost:3000/api/auth/permissions?component=sales.kpis

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå module
curl http://localhost:3000/api/auth/permissions?module=sales

# ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ roles ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
curl http://localhost:3000/api/auth/roles
```

### 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ Role

| Role | Login | ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£ |
|------|-------|----------|
| Admin | `admin` | ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á, ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á |
| Manager | `manager` | ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (view-only) |
| Sales | `sales01` | ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Sales & Inventory ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô |
| Purchase | `purchase01` | ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Purchase & Inventory |
| Accountant | `accountant` | ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Accounting ‡πÅ‡∏•‡∏∞ financial data |

---

## ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Role ‡∏´‡∏£‡∏∑‡∏≠ Permission ‡πÉ‡∏´‡∏°‡πà

### ‡πÄ‡∏û‡∏¥‡πà‡∏° Role ‡πÉ‡∏´‡∏°‡πà

1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `src/lib/permissions/mockData.ts`
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Role object ‡πÉ‡∏´‡∏°‡πà:

```typescript
export const CustomRole: Role = {
  id: 'custom',
  name: 'Custom Role',
  description: '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Role ‡∏ô‡∏µ‡πâ',
  permissions: [
    {
      module: 'sales',
      level: 'view',
      components: {
        'sales.kpis': 'view',
        'sales.trend': 'view',
        // ...
      },
    },
    // ... modules ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  ],
};
```

3. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `mockUsers` array

### ‡πÄ‡∏û‡∏¥‡πà‡∏° Component Key ‡πÉ‡∏´‡∏°‡πà

1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `src/lib/permissions/types.ts`
2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `ComponentKey` type:

```typescript
export type ComponentKey =
  // ... existing keys
  | 'sales.new_component'
  | 'inventory.new_feature';
```

3. Update Role ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á

---

## Best Practices

### 1. ‡πÉ‡∏ä‡πâ PermissionGuard ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å Component ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
```tsx
‚úÖ Good
<PermissionGuard componentKey="sales.kpis">
  <KPICards />
</PermissionGuard>

‚ùå Bad
<KPICards /> // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
```

### 2. ‡πÉ‡∏ä‡πâ ErrorBoundary ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö PermissionGuard
```tsx
<PermissionGuard componentKey="sales.trend">
  <ErrorBoundary>
    <SalesTrendChart data={data} />
  </ErrorBoundary>
</PermissionGuard>
```

### 3. ‡πÉ‡∏ä‡πâ `hideDenied` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```tsx
<PermissionGuard componentKey="accounting.balance_sheet" hideDenied>
  <BalanceSheet />
</PermissionGuard>
```

### 4. ‡πÉ‡∏ä‡πâ Hook ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Logic ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
```tsx
const { allowed, level } = useComponentPermission('sales.top_customers');

if (!allowed) return null;

return (
  <div>
    <Table data={customers} />
    {level === 'full' && <Button>Export</Button>}
  </div>
);
```

---

## Troubleshooting

### ‚ùì Component ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Component Key ‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô `types.ts` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Role ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î permission ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö component ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `PermissionProvider` ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏û‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

### ‚ùì Error: usePermissions must be used within a PermissionProvider

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `<PermissionProvider>` ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `layout.tsx` ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö `{children}` ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

### ‚ùì ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô User ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£

- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `src/lib/permissions/mockData.ts` ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getMockCurrentUser()`
- ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Switch User (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö development)

---

## üìù ‡∏™‡∏£‡∏∏‡∏õ

‡∏£‡∏∞‡∏ö‡∏ö Permission ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì:
- ‚úÖ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ Component ‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- ‚úÖ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Role ‡πÅ‡∏•‡∏∞ Permission ‡πÅ‡∏ö‡∏ö centralized
- ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ Mock Data
- ‚úÖ ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Feature ‡πÉ‡∏´‡∏°‡πà

**Happy Coding! üöÄ**
